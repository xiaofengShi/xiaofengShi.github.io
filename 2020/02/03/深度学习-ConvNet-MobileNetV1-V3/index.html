<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/panda_32px.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/panda_16px.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-mac-osx.min.css">
  <script src="/lib/pace/pace.min.js"></script>


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://xiaofengshi.com').hostname,
    root: '/',
    scheme: 'Pisces',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":true,"show_result":true,"style":"mac"},
    back2top: {"enable":true,"sidebar":true,"scrollpercent":true},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":-1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="本篇主要对目前流行的移动端轻量化网络MobileNet进行分析。 最近一段时间由于工作需要，想要将服务端的模型迁移到移动端，突然发现一个尴尬的现实，服务端的大模型在移动端是很难跑起来的。随着5G技术的到来，端上设备越来越强悍，将模型做到移动端是一个很显然的大趋势。目前的移动端模型 ( https:&#x2F;&#x2F;www.tensorflow.org&#x2F;lite&#x2F;models&#x2F; )，主要跑的是CV相关方面的识">
<meta property="og:type" content="article">
<meta property="og:title" content="深度学习-ConvNet-MobileNetV1-V3">
<meta property="og:url" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/index.html">
<meta property="og:site_name" content="做一个有用的人">
<meta property="og:description" content="本篇主要对目前流行的移动端轻量化网络MobileNet进行分析。 最近一段时间由于工作需要，想要将服务端的模型迁移到移动端，突然发现一个尴尬的现实，服务端的大模型在移动端是很难跑起来的。随着5G技术的到来，端上设备越来越强悍，将模型做到移动端是一个很显然的大趋势。目前的移动端模型 ( https:&#x2F;&#x2F;www.tensorflow.org&#x2F;lite&#x2F;models&#x2F; )，主要跑的是CV相关方面的识">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/pose_estimation.gif">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenet_Struct.png">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenet_conv.png">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenetV1_block.png">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenet_cov2.png">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobile_param.png">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenetv2-block.png">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/MobilenetV2-ExpandProject.png">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/MobileNetV2-LowDimensionality.png">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/MobileNetV2-Compression.png">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilnetv2-params.png">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/comparison.png">
<meta property="og:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenetv2-compare.png">
<meta property="article:published_time" content="2020-02-03T13:16:01.000Z">
<meta property="article:modified_time" content="2020-02-16T14:16:57.000Z">
<meta property="article:author" content="ShiXiaofeng">
<meta property="article:tag" content="深度学习">
<meta property="article:tag" content="ConvNet">
<meta property="article:tag" content="CV">
<meta property="article:tag" content="轻量化Conv">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/pose_estimation.gif">

<link rel="canonical" href="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>深度学习-ConvNet-MobileNetV1-V3 | 做一个有用的人</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">做一个有用的人</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <h1 class="site-subtitle" itemprop="description">LLM And Search</h1>
      
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-fw fa-calendar"></i>日程表</a>

  </li>
        <li class="menu-item menu-item-guestbook">

    <a href="/guestbook/" rel="section"><i class="fa fa-fw fa-commenting"></i>guestbook</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/xiaofengShi" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ShiXiaofeng">
      <meta itemprop="description" content="LLM,搜索,数据挖掘,深度学习相关技术记录分享">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="做一个有用的人">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          深度学习-ConvNet-MobileNetV1-V3
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-02-03 21:16:01" itemprop="dateCreated datePublished" datetime="2020-02-03T21:16:01+08:00">2020-02-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-02-16 22:16:57" itemprop="dateModified" datetime="2020-02-16T22:16:57+08:00">2020-02-16</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">深度学习</span>
                  </a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/CV/" itemprop="url" rel="index">
                    <span itemprop="name">CV</span>
                  </a>
                </span>
            </span>

          
            <span id="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/" class="post-meta-item leancloud_visitors" data-flag-title="深度学习-ConvNet-MobileNetV1-V3" title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="fa fa-comment-o"></i>
      </span>
      <span class="post-meta-item-text">Valine：</span>
    
    <a title="valine" href="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/" itemprop="commentCount"></span>
    </a>
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/pose_estimation.gif" class="" title="Pose estimation">

<p>本篇主要对目前流行的移动端轻量化网络MobileNet进行分析。</p>
<p>最近一段时间由于工作需要，想要将服务端的模型迁移到移动端，突然发现一个尴尬的现实，服务端的大模型在移动端是很难跑起来的。随着5G技术的到来，端上设备越来越强悍，将模型做到移动端是一个很显然的大趋势。目前的移动端模型 ( <a href="https://www.tensorflow.org/lite/models/">https://www.tensorflow.org/lite/models/</a> )，主要跑的是CV相关方面的识别，检测模型，姿态预估等相对简单的模型，并且目前的模型很多是基于<code>MobileNet</code>这一网络的，本篇就主要针对<code>Mobilenet</code>进行研究分析。</p>
<span id="more"></span>

<h2 id="MobileNetV1"><a href="#MobileNetV1" class="headerlink" title="MobileNetV1"></a>MobileNetV1</h2><p>同样是针对移动端进行优化，使用<code>mobilenet</code>替代常规的卷积方式，由于<code>Mobilenet</code>的深度可分离卷积结构设计，目前，在工业界<code>Mobilenet</code>是移动端部署使用最广泛的，到2019年已经公布了MobilenetV3版本，该网络被广泛用于移动端的图像识别，检测等任务。</p>
<p><a href="https://arxiv.org/pdf/1704.04861.pdf">论文链接🔥 MobileNets: Efficient Convolutional Neural Networks for Mobile Vision</a></p>
<h3 id="设计思路"><a href="#设计思路" class="headerlink" title="设计思路"></a>设计思路</h3><p>在进行小型高效的神经网络时，一般两种思路:</p>
<ul>
<li><p>压缩模型</p>
<p>获得小型网络的一个办法是减小、分解或压缩预训练网络，例如量化压缩(product quantization)、哈希(hashing )、剪枝(pruning)、矢量编码( vector quantization)和霍夫曼编码(Huffman coding)等；此外还有各种分解因子(various factorizations )用来加速预训练网络；还有一种训练小型网络的方法叫蒸馏(distillation )，使用大型网络指导小型网络，例如上面的<code>squeezenet</code>。</p>
</li>
<li><p>直接训练小模型</p>
<p>例如<code>Flattened networks</code>利用完全的因式分解的卷积网络构建模型，显示出完全分解网络的潜力；<code>Factorized Networks</code>引入了类似的分解卷积以及拓扑连接的使用；<code>Xception network</code>显示了如何扩展深度可分离卷积到<code>Inception V3 networks</code>；<code>Squeezenet </code>使用一个bottleneck用于构建小型网络。</p>
</li>
</ul>
<h3 id="深度可分离卷积"><a href="#深度可分离卷积" class="headerlink" title="深度可分离卷积"></a>深度可分离卷积</h3><p><code>Mobilenet</code>主要注重于优化延迟的同时考虑小型的模型，从深度可分离卷积的角度构建模型。</p>
<p><strong><code>mobilenet</code>基于深度可分离卷积，将标准卷积分解成深度卷积(<code>depthwise convolution</code>)和逐点卷积(<code>pointwise convolution</code>)，通过此举大幅度降低参数量和计算量</strong></p>
<hr>

<img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenet_Struct.png" class="">

<p>图中的浅色代表的是下一个<code>block</code>的开始，并且注意方块代表的是特征图，而红色映射才是卷积或者<code>ReLU</code>操作。$a$表示的是普通卷积方式，$b$表示的就是在<code>MobileNet</code>中广泛使用的深度可分离卷积(<code>Depthwise Separable Convolution</code>)，先进行<code>Depthwise</code>再进行<code>Pointwise</code><hr></p>
<ul>
<li><p>普通卷积计算</p>
<p>假设输入的<code>featuremap</code>为$12 \times 12 \times 4$，卷积为<code>conv_3-2</code>,则对应的计算量为$12\times12\times2\times(3\times3\times4)&#x3D;10368$，参数量为(卷积核带来的参数) $3\times3\times4\times2&#x3D;72$，如下图所示</p>
<hr> image comes from https://blog.csdn.net/huachao1001/article/details/79171447

  <img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenet_conv.png" class="" title="mobilenet convolution">

<hr>

</li>
<li><p>深度可分离卷积</p>
<p>在<code>Mobilenet</code>中将卷积操作进行了分解，分解为深度卷积和逐点卷积</p>
<hr></li>
</ul>
<img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenetV1_block.png" class="">
  <hr>

<p> <strong>深度卷积<code>DepthwiseConvolution</code>与传统的卷积方式不同</strong></p>
<ul>
<li><p>对于传统的卷积，卷积核在输入特征图的所有通道上共享参数，输出的通道数由卷积核的数量决定</p>
</li>
<li><p>深度卷积对输入的特征图的每个通道上使用不同的卷积核，一个卷积核对应一个输入通道</p>
</li>
</ul>
<p>  所以可以说<code>DepthwiseConvolution</code>是depth级别的操作。</p>
<p>  对于这一步的深度卷积有一篇回答特别棒 <a href="https://stackoverflow.com/questions/45369920/tensorflow-what-exactly-does-depthwise-convolution-do">https://stackoverflow.com/questions/45369920/tensorflow-what-exactly-does-depthwise-convolution-do</a></p>
<p>  为防止链接挂掉，引用代码如下</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="comment"># batch of 2 inputs of 13x13 pixels with 3 channels each.</span></span><br><span class="line"><span class="comment"># Four 5x5 filters applied to each channel, so 12 total channels output</span></span><br><span class="line">inputs_np = np.ones((<span class="number">2</span>, <span class="number">13</span>, <span class="number">13</span>, <span class="number">3</span>))</span><br><span class="line">inputs = tf.constant(inputs_np)</span><br><span class="line"><span class="comment"># Build the filters so that their behavior is easier to understand.  For these filters</span></span><br><span class="line"><span class="comment"># which are 5x5, I set the middle pixel (location 2,2) to some value and leave</span></span><br><span class="line"><span class="comment"># the rest of the pixels at zero</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># <span class="doctag">NOTE:</span> 5x5 filters for 3 inputs and applying 4 such filters to each one. here &#x27;3&#x27; equal with the input tensor&#x27;s channel num S</span></span><br><span class="line">filters_np = np.zeros((<span class="number">5</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">4</span>)) </span><br><span class="line"></span><br><span class="line"><span class="comment"># <span class="doctag">NOTE:</span> for betweer display, fileter is zeros, except bellow positions </span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">0</span>] = <span class="number">2.0</span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>] = <span class="number">2.1</span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">2</span>] = <span class="number">2.2</span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">3</span>] = <span class="number">2.3</span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">0</span>] = <span class="number">3.0</span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>] = <span class="number">3.1</span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>] = <span class="number">3.2</span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>] = <span class="number">3.3</span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">0</span>] = <span class="number">4.0</span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>] = <span class="number">4.1</span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>] = <span class="number">4.2</span></span><br><span class="line">filters_np[<span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">3</span>] = <span class="number">4.3</span></span><br><span class="line">filters = tf.constant(filters_np)</span><br><span class="line">out = tf.nn.depthwise_conv2d(</span><br><span class="line">      inputs,</span><br><span class="line">      filters,</span><br><span class="line">      strides=[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>],</span><br><span class="line">      padding=<span class="string">&#x27;SAME&#x27;</span>)</span><br><span class="line"><span class="keyword">with</span> tf.Session() <span class="keyword">as</span> sess:</span><br><span class="line">    sess.run(tf.global_variables_initializer())</span><br><span class="line">    out_val = out.<span class="built_in">eval</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output dim is &#123;&#125;&quot;</span>.<span class="built_in">format</span>(out_val.shape))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;output cases 0 and 1 identical? &#123;&#125;&quot;</span>.<span class="built_in">format</span>(np.<span class="built_in">all</span>(out_val[<span class="number">0</span>]==out_val[<span class="number">1</span>])))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;One of the pixels for each of the 12 output &#123;&#125;&quot;</span>.<span class="built_in">format</span>(out_val[<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]))</span><br><span class="line"><span class="comment"># Output:</span></span><br><span class="line"><span class="comment"># output dim is (2, 13, 13, 12)</span></span><br><span class="line"><span class="comment"># output cases 0 and 1 identical? True</span></span><br><span class="line"><span class="comment"># One of the pixels for each of the 12 output [2.  2.1 2.2 2.3 3.  3.1 3.2 3.3 4.  4.1 4.2 4.3]</span></span><br></pre></td></tr></table></figure>

<p>  <strong><code>PointwiseConvolution</code>其实就是普通的卷积，只不过采用1x1的卷积核</strong>。假设输入为<code>M*N*C</code>，原来的卷积为<code>conv3-k</code>，对应着<code>k</code>个<code>3x3</code>的卷积核，输出为<code>M*N*k</code>，现在将其进行改变成两步进行</p>
<ul>
<li>第一步：depthwise conv—输入为<code>M*N*C</code>，卷积为<code>conv3-1</code>，输出为<code>M*N*C</code></li>
<li>第二步：pointwise conv —输入为<code>M*N*C</code>，卷积为<code>conv1-k</code>，输出为<code>M*N*k</code></li>
</ul>
<p>  最终输出的<code>feature map</code>尺寸相同，但是会很大程度减少参数量。</p>
<p>  使用和普通卷积同样的参数进行演示，如下所示，输入的<code>feature map</code>的尺寸为$12 \times 12 \times 4$</p>
<ul>
<li><p>第一步<code>DepthwiseConv</code>—卷积为<code>conv3-1</code>,</p>
<ul>
<li><p>计算量：$12 \times 12 \times 1\times  3 \times 3 \times 4 &#x3D;  5184$</p>
</li>
<li><p>参数量：$1\times 3 \times 3 \times 4&#x3D;36$</p>
<p>对$4$个通道每个通道都与一个$3\times3$的卷积核计算</p>
</li>
<li><p>输出的特征图大小为$12\times12\times4$</p>
</li>
</ul>
</li>
<li><p>第二步<code>PointwiseConv</code>-卷积为<code>conv1-2</code>，输入的尺寸为$12 \times 12 \times 4$</p>
<ul>
<li>计算量：$12 \times 12 \times 2 \times (1 \times 1 \times 4)&#x3D;1152$</li>
<li>参数量： $2 \times (1 \times 1 \times 4)&#x3D; 8$</li>
<li>输出特征图大小为$12 \times 12 \times 2$</li>
</ul>
</li>
</ul>
  <img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenet_cov2.png" class="" title="mobilenet">

<p>  比较普通卷积计算方式和<code>mobilenet</code>的计算方式，可以看到参数量由$72$较少到了$44$；计算量由$10368$减少到了$6336$。</p>
<p>  深度可分离卷积可以看做是<code>InceptionNet</code>中的结构的极致设计，详细分析在这里<a href="https://zhuanlan.zhihu.com/p/29367273">👉👉👉</a></p>
<h3 id="网络参数"><a href="#网络参数" class="headerlink" title="网络参数"></a>网络参数</h3><p>对<code>Mobilenet</code>的网络参数如下图所示</p>
<hr>

  <img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobile_param.png" class="" title="mobilenet params">

<hr>

<p>  除了在最后的全连接层没有使用非线性激活函数，其他层均使用<code>BN+Relu6</code>策略。</p>
<h2 id="MobileNetV2"><a href="#MobileNetV2" class="headerlink" title="MobileNetV2"></a>MobileNetV2</h2><p><a href="https://arxiv.org/abs/1801.04381">论文链接🔥 MobileNetV2: Inverted Residuals and Linear Bottlenecks</a></p>
<p>参考链接 </p>
<ul>
<li><a href="https://machinethink.net/blog/mobilenet-v2/">https://machinethink.net/blog/mobilenet-v2/</a> </li>
<li><a href="https://www.zybuluo.com/Team/note/1350161">https://www.zybuluo.com/Team/note/1350161</a></li>
</ul>
<h3 id="V2相比于V1版本的升级"><a href="#V2相比于V1版本的升级" class="headerlink" title="V2相比于V1版本的升级"></a>V2相比于V1版本的升级</h3><p>针对<code>MobileNet</code>进行升级，开发了<code>V2</code>版本，在<code>V1</code>版本中核心点是深度可分离卷积，在<code>MobileNetV2</code>中仍然采用的是深度可分离卷积，不同的是在此基础上又引入了残差结构以及<code>bottleneck</code>瓶颈层，<code>MobileNetV2</code>的可以看成一系列<strong>Bottleneck residual block</strong>的结构的堆叠，如下所示</p>
<hr>

<img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenetv2-block.png" class="" title="MobileNetV2 Block">

<hr>

<p>不同的点这里说明一下：</p>
<p>自上而下对<code>MobileNetV2</code>中使用的<code>Block</code>进行分析</p>
<ol>
<li><p><code>ExpansionLayer</code></p>
<p><strong>扩展层</strong>，这一部分使用的是$1 \times 1$ 的卷积，作用是为了扩充输入当前Block的特征图的通道数量，因此，扩展层始终具有比输入通道更多的输出通道。通道数量的扩展量由扩展因子决定。这是一个超参数。默认扩展因子为6，也就是扩展通道数$6$倍。</p>
</li>
<li><p>DepthwiseLayer</p>
<p>这里的深度卷积与<code>MobileNetV1</code>中是相同的，不变换通道的数量，这里主要是为了参数量。</p>
</li>
<li><p>ProjectionLayer</p>
<p>投影层。在这一层可以理解成pointwise，使用的是和<code>MobileNetV1</code>中相同的$1 \times 1$卷积，这里区别于MobileNetV1的地方：</p>
<ol>
<li>在MobileNetV1中，pointwise的输出通道数量保持不变或者加倍</li>
<li>在MobileNetV2中，输出通道数量减少</li>
</ol>
<p>这也是为什么在<code>MobileNetV2</code>中这一层被称作投影层。在这一层，通道数量减少，可以理解成创建了一个高纬度到低纬度的映射。</p>
</li>
</ol>
<p>每个Block的输出都是将输出的维度进行从高纬度到低纬度的变换，这也是每个block叫做<strong>bottleneck residual block</strong>的原因</p>
<hr>下图为MobileNetV2中Bottleneck residual block示意图。

<img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/MobilenetV2-ExpandProject.png" class="" title="MobileNetV2 Bottleneck">

<p>假设输入的通道数为24，经过<code>expansion</code>层之后，扩展$6$倍，变成$144$层，经过<code>depthwise</code>层，通道层数不变，经过<code>projection</code>层,通道数变为$24$，使用<code>ResNet</code>相同的方式连接<code>Block</code>的输入和输出，也就是进出模块的的特征图是低纬度的，在<code>Block</code>内部则是高纬度的，这就是<code>MobileNetV2</code>中广泛使用的结构。<hr></p>
<p>在每个<code>Bllock</code>中，每个层都是<code>BN+Relu6</code>，除了最后一步的<code>ProjectionLayer</code>，在<code>ProjectionLayer</code>中没有使用激活函数，由于这一层的作用是进行从高通道数向低通道数的映射，使用非线性激活会使得有效信息丢失，在这里模型中使用的直接就是线性映射，没有使用激活函数。</p>
<p>整个<code>MobileNetV2</code>使用了$17$个<code>Block</code>结构进行串联叠加（第1个Block稍有不同，它使用具有32个通道的常规$3 \times 3$卷积代替扩展层中的$1 \times 1$卷积)，最后就是标准的卷积核全局池化和分类层（这个是为适配图片识别任务，将MobileNetV2当做其他任务的基础网络的时候，这一部分不需要。）</p>
<h3 id="V2升级的动机"><a href="#V2升级的动机" class="headerlink" title="V2升级的动机"></a>V2升级的动机</h3><p>在V1中，模型设计的出发点是减少卷积的参数量并且减少计算量，即便使用更多的层数也没关系，因此在V1中引入了深度可分离卷积，事实证明这个方法是可行的，在V2中，相比与V1的变化主要在借鉴ResNet的残差连接和Block中的ExpansionLayer和ProjectionLayer。</p>
<p>分析MobileNetV2的结构可以看到，在整个模型中各个Block之间数据的通道数都是很小的</p>
<img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/MobileNetV2-LowDimensionality.png" class="">

<p>由于ProjectionLayer的存在，使得相邻Block之间传递的数据维度很小，这很大程度减少了模型的计算量。但是只使用低纬度的数据特征，无法有效的提高模型的准确性，这个问题由ExpansionLayer来解决，该层的设计使得在每个Block中扩大输入当前特征图通道的数量，并且由于残差模块的存在，该层能够显著的提高模型的表达能力。</p>
<p>一个很有意思的解释：ProjectionLayer可以理解成为了减少计算量对数据进行的压缩，ExpansionLayer可以理解成为为了更好的表达特征图，对压缩过的数据进行解压缩，流经Depthwise的数据可以看做是真实的数据维度。</p>
<img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/MobileNetV2-Compression.png" class="">

<p>从图中可以看出，在每个<code>Blcok</code>模块中首尾链接，内部对数据解压缩(<code>expansion</code>)，进行<code>depthwise</code>卷积操作，然后对数据进行压缩(<code>projection</code>)，传递到下一个<code>block</code>中。</p>
<hr>

<img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilnetv2-params.png" class="">

<p>如上所示便是MobileNetV2的模型结构，t表示的是expansion层的扩展系数，c是输出的通道数，n表示当前block重复了几次，s表示步长<hr></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>先上图，这是MobileNetV2和其他移动端模型的对比。</p>
<hr>

<img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/comparison.png" class="">

<hr>

<p>MobileNetV2是在V1的基础上升级而来，当然它的竞品是其他的轻量卷积模型shufflenet，nasnet这些。</p>
<hr>

<img src="/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/mobilenetv2-compare.png" class="">

<hr>

<p>在对比指标中可以看出来，MobileNetV2相比于几个网络时更有优势的。</p>
<h2 id="MobilenetV3"><a href="#MobilenetV3" class="headerlink" title="MobilenetV3"></a>MobilenetV3</h2><h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h2><ol>
<li>官方代码 <a href="https://github.com/tensorflow/models/tree/master/research/slim/nets/mobilenet">https://github.com/tensorflow/models/tree/master/research/slim/nets/mobilenet</a></li>
</ol>

    </div>

    
    
    
        <div class="reward-container">
  <div>赏杯咖啡！</div>
  <button onclick="var qr = document.getElementById('qr'); qr.style.display = (qr.style.display === 'none') ? 'block' : 'none';">
    打赏
  </button>
  <div id="qr" style="display: none;">
      
      <div style="display: inline-block;">
        <img src="/images/wechat.jpeg" alt="ShiXiaofeng 微信支付">
        <p>微信支付</p>
      </div>
      
      <div style="display: inline-block;">
        <img src="/images/alipay.jpeg" alt="ShiXiaofeng 支付宝">
        <p>支付宝</p>
      </div>

  </div>
</div>

        

<div>
<ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者： </strong>ShiXiaofeng
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://xiaofengshi.com/2020/02/03/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-ConvNet-MobileNetV1-V3/" title="深度学习-ConvNet-MobileNetV1-V3">http://xiaofengshi.com/2020/02/03/深度学习-ConvNet-MobileNetV1-V3/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fa fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" rel="tag"># 深度学习</a>
              <a href="/tags/ConvNet/" rel="tag"># ConvNet</a>
              <a href="/tags/CV/" rel="tag"># CV</a>
              <a href="/tags/%E8%BD%BB%E9%87%8F%E5%8C%96Conv/" rel="tag"># 轻量化Conv</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/02/05/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0-Convolution-Summary/" rel="prev" title="深度学习-Convolution-Summary">
      <i class="fa fa-chevron-left"></i> 深度学习-Convolution-Summary
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/01/29/Awesomes-Python/" rel="next" title="Awesomes-Python">
      Awesomes-Python <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#MobileNetV1"><span class="nav-number">1.</span> <span class="nav-text">MobileNetV1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%BE%E8%AE%A1%E6%80%9D%E8%B7%AF"><span class="nav-number">1.1.</span> <span class="nav-text">设计思路</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B7%B1%E5%BA%A6%E5%8F%AF%E5%88%86%E7%A6%BB%E5%8D%B7%E7%A7%AF"><span class="nav-number">1.2.</span> <span class="nav-text">深度可分离卷积</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%BB%9C%E5%8F%82%E6%95%B0"><span class="nav-number">1.3.</span> <span class="nav-text">网络参数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MobileNetV2"><span class="nav-number">2.</span> <span class="nav-text">MobileNetV2</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#V2%E7%9B%B8%E6%AF%94%E4%BA%8EV1%E7%89%88%E6%9C%AC%E7%9A%84%E5%8D%87%E7%BA%A7"><span class="nav-number">2.1.</span> <span class="nav-text">V2相比于V1版本的升级</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#V2%E5%8D%87%E7%BA%A7%E7%9A%84%E5%8A%A8%E6%9C%BA"><span class="nav-number">2.2.</span> <span class="nav-text">V2升级的动机</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BB%93"><span class="nav-number">2.3.</span> <span class="nav-text">总结</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#MobilenetV3"><span class="nav-number">3.</span> <span class="nav-text">MobilenetV3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E9%93%BE%E6%8E%A5"><span class="nav-number">4.</span> <span class="nav-text">参考链接</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ShiXiaofeng"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">ShiXiaofeng</p>
  <div class="site-description" itemprop="description">LLM,搜索,数据挖掘,深度学习相关技术记录分享</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">44</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">47</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xiaofengShi" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;xiaofengShi" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:sxf1052566766@163.com" title="E-Mail → mailto:sxf1052566766@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2018 – 
  <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ShiXiaofeng</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v7.1.1
  </div>

        








      </div>
    </footer>
  </div>

  
  
  <script color='0,0,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>









<script>
if (document.querySelectorAll('div.pdf').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/pdfobject@2/pdfobject.min.js', () => {
    document.querySelectorAll('div.pdf').forEach(element => {
      PDFObject.embed(element.getAttribute('target'), element, {
        pdfOpenParams: {
          navpanes: 0,
          toolbar: 0,
          statusbar: 0,
          pagemode: 'thumbs',
          view: 'FitH'
        },
        PDFJS_URL: '/lib/pdf/web/viewer.html',
        height: element.getAttribute('height') || '500px'
      });
    });
  }, window.PDFObject);
}
</script>


<script>
if (document.querySelectorAll('pre.mermaid').length) {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js', () => {
    mermaid.initialize({
      theme: 'forest',
      logLevel: 3,
      flowchart: { curve: 'linear' },
      gantt: { axisFormat: '%m/%d/%Y' },
      sequence: { actorMargin: 50 }
    });
  }, window.mermaid);
}
</script>


  

  
      
<script type="text/x-mathjax-config">

  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$', '$'], ['\\(', '\\)'] ],
      processEscapes: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      equationNumbers: {
        autoNumber: 'AMS'
      }
    }
  });

  MathJax.Hub.Register.StartupHook('TeX Jax Ready', function() {
    MathJax.InputJax.TeX.prefilterHooks.Add(function(data) {
      if (data.display) {
        var next = data.script.nextSibling;
        while (next && next.nodeName.toLowerCase() === '#text') {
          next = next.nextSibling;
        }
        if (next && next.nodeName.toLowerCase() === 'br') {
          next.parentNode.removeChild(next);
        }
      }
    });
  });

  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for (i = 0; i < all.length; i += 1) {
      element = document.getElementById(all[i].inputID + '-Frame').parentNode;
      if (element.nodeName.toLowerCase() == 'li') {
        element = element.parentNode;
      }
      element.classList.add('has-jax');
    }
  });
</script>
<script>
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML', () => {
    MathJax.Hub.Typeset();
  }, window.MathJax);
</script>

    

  


<script>
NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el: '#valine-comments',
      verify: false,
      notify: false,
      appId: 'rBlWbsM2JDda6CTwJlGaUFpI-gzGzoHsz',
      appKey: 'zJasiQnAqgUwf4kiHhHyXwOP',
      placeholder: "Leave Your Message and Contact Details",
      avatar: 'mm',
      meta: guest,
      pageSize: '10' || 10,
      visitor: true,
      lang: '' || 'zh-cn',
      path: location.pathname,
      recordIP: false,
      serverURLs: ''
    });
  }, window.Valine);
});
</script>

</body>
</html>
